<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute evaluation criteria for PLS, sPLS, PLS-DA and sPLS-DA — perf • sgPLS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute evaluation criteria for PLS, sPLS, PLS-DA and sPLS-DA — perf"><meta name="description" content="Function to evaluate the performance of the fitted sparse PLS, group PLS, sparse group PLS, sparse PLS-DA, group PLS-DA and sparse group PLS-DA models using various criteria."><meta property="og:description" content="Function to evaluate the performance of the fitted sparse PLS, group PLS, sparse group PLS, sparse PLS-DA, group PLS-DA and sparse group PLS-DA models using various criteria."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sgPLS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications"><li><a class="dropdown-item" href="../applications/PLS_performance.html">PLS performance</a></li>
    <li><a class="dropdown-item" href="../applications/PLSDA_performance.html">PLSDA performance</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute evaluation criteria for PLS, sPLS, PLS-DA and sPLS-DA</h1>

      <div class="d-none name"><code>perf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to evaluate the performance of the fitted sparse PLS, group PLS, sparse group PLS, sparse PLS-DA, group PLS-DA and sparse group PLS-DA models using various criteria.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'sPLS'</span></span>
<span><span class="fu">perf</span><span class="op">(</span><span class="va">object</span>, </span>
<span>          criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"MSEP"</span>, <span class="st">"R2"</span>, <span class="st">"Q2"</span><span class="op">)</span>, </span>
<span>          validation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mfold"</span>, <span class="st">"loo"</span><span class="op">)</span>, </span>
<span>          folds <span class="op">=</span> <span class="fl">10</span>, progressBar <span class="op">=</span> <span class="cn">TRUE</span>, setseed <span class="op">=</span> <span class="fl">1</span>,<span class="va">...</span><span class="op">)</span></span>
<span>          </span>
<span><span class="co"># S3 method for class 'gPLS'</span></span>
<span><span class="fu">perf</span><span class="op">(</span><span class="va">object</span>, </span>
<span>          criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"MSEP"</span>, <span class="st">"R2"</span>, <span class="st">"Q2"</span><span class="op">)</span>, </span>
<span>          validation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mfold"</span>, <span class="st">"loo"</span><span class="op">)</span>, </span>
<span>          folds <span class="op">=</span> <span class="fl">10</span>, progressBar <span class="op">=</span> <span class="cn">TRUE</span>, setseed <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span>          </span>
<span><span class="co"># S3 method for class 'sgPLS'</span></span>
<span><span class="fu">perf</span><span class="op">(</span><span class="va">object</span>, </span>
<span>          criterion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"MSEP"</span>, <span class="st">"R2"</span>, <span class="st">"Q2"</span><span class="op">)</span>, </span>
<span>          validation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mfold"</span>, <span class="st">"loo"</span><span class="op">)</span>, </span>
<span>          folds <span class="op">=</span> <span class="fl">10</span>, progressBar <span class="op">=</span> <span class="cn">TRUE</span>,setseed <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span>          </span>
<span>          </span>
<span><span class="co"># S3 method for class 'sPLSda'</span></span>
<span><span class="fu">perf</span><span class="op">(</span><span class="va">object</span>,</span>
<span>          method.predict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"max.dist"</span>, <span class="st">"centroids.dist"</span>, <span class="st">"mahalanobis.dist"</span><span class="op">)</span>,</span>
<span>          validation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mfold"</span>, <span class="st">"loo"</span><span class="op">)</span>, </span>
<span>          folds <span class="op">=</span> <span class="fl">10</span>, progressBar <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># S3 method for class 'gPLSda'</span></span>
<span><span class="fu">perf</span><span class="op">(</span><span class="va">object</span>,</span>
<span>          method.predict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"max.dist"</span>, <span class="st">"centroids.dist"</span>, <span class="st">"mahalanobis.dist"</span><span class="op">)</span>,</span>
<span>          validation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mfold"</span>, <span class="st">"loo"</span><span class="op">)</span>, </span>
<span>          folds <span class="op">=</span> <span class="fl">10</span>, progressBar <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span>          </span>
<span><span class="co"># S3 method for class 'sgPLSda'</span></span>
<span><span class="fu">perf</span><span class="op">(</span><span class="va">object</span>,</span>
<span>          method.predict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"max.dist"</span>, <span class="st">"centroids.dist"</span>, <span class="st">"mahalanobis.dist"</span><span class="op">)</span>,</span>
<span>          validation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mfold"</span>, <span class="st">"loo"</span><span class="op">)</span>, </span>
<span>          folds <span class="op">=</span> <span class="fl">10</span>, progressBar <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>Object of class inheriting from <code>"sPLS"</code>, <code>"gPLS"</code>, <code>"sgPLS"</code>, <code>"sPLSda"</code>, <code>"gPLSda"</code> or <code>"sgPLSda"</code>. The function will retrieve some key parameters stored in that object.</p></dd>

    <dt id="arg-criterion">criterion<a class="anchor" aria-label="anchor" href="#arg-criterion"></a></dt>
<dd><p>The criteria measures to be calculated (see Details). Can be set to either <code>"all"</code>, <code>"MSEP"</code>, <code>"R2"</code>, <code>"Q2"</code>. By default set to <code>"all"</code>. Only applies to an object inheriting from <code>"sPLS"</code>, <code>"gPLS"</code> or <code>"sgPLS"</code></p></dd>

  <dt id="arg-method-predict">method.predict<a class="anchor" aria-label="anchor" href="#arg-method-predict"></a></dt>
<dd><p>only applies to an object inheriting from <code>"PLSda"</code>, <code>"gPLSda"</code> or <code>"sgPLSda"</code> to evaluate the classification performance of the model. Should be a subset of <code>"max.dist"</code>, <code>"centroids.dist"</code>, <code>"mahalanobis.dist"</code>. Default is <code>"all"</code>. See <code><a href="https://rdrr.io/pkg/mixOmics/man/predict.html" class="external-link">predict</a></code>.</p></dd>

  <dt id="arg-validation">validation<a class="anchor" aria-label="anchor" href="#arg-validation"></a></dt>
<dd><p>Character.  What kind of (internal) validation to use, matching one of <code>"Mfold"</code> or
    <code>"loo"</code> (see below). Default is <code>"Mfold"</code>.</p></dd>

  <dt id="arg-folds">folds<a class="anchor" aria-label="anchor" href="#arg-folds"></a></dt>
<dd><p>The folds in the Mfold cross-validation. See Details.</p></dd>

  <dt id="arg-progressbar">progressBar<a class="anchor" aria-label="anchor" href="#arg-progressbar"></a></dt>
<dd><p>By default set to <code>TRUE</code> to output the progress bar of the computation.</p></dd>

  <dt id="arg-setseed">setseed<a class="anchor" aria-label="anchor" href="#arg-setseed"></a></dt>
<dd><p>Integer value to specify the random generator state.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Not used at the moment.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The method <code>perf</code> has been created by Sebastien Dejean, Ignacio Gonzalez, Amrit Singh and Kim-Anh Le Cao for pls and spls models performed by <code>mixOmics</code> package. Similar code has been adapted for sPLS, gPLS and sgPLS in the package <code>sgPLS</code>.</p>	
	
<p><code>perf</code> estimates the
mean squared error of prediction (MSEP), \(R^2\), and \(Q^2\) to assess the predictive
performance of the model using M-fold or leave-one-out cross-validation. Note that only the <code>classic</code>, <code>regression</code> and  <code>invariant</code> modes can be applied.</p>
<p>If <code>validation = "Mfold"</code>, M-fold cross-validation is performed.
How many folds to generate is selected by specifying the number of folds in <code>folds</code>.
The folds also can be supplied as a list of vectors containing the indexes defining each
fold as produced by <code>split</code>.
If <code>validation = "loo"</code>, leave-one-out cross-validation is performed.</p>
<p>For fitted sPLS-DA, gPLS-DA and sgPLS-DA models, <code>perf</code> estimates the classification error rate
using cross-validation.</p>
<p>Note that the <code>perf</code> function will retrieve the <code>keepX</code> and <code>keepY</code> inputs from the previously run object. The sPLS, gPLS, sgPLS, sPLSda, gPLSda or sgPLSda functions will be run again on several and different subsets of data (the cross-folds) and certainly on different subset of selected features. For sPLS, the MSEP, \(R^2\), and \(Q^2\) criteria are averaged across all folds. A feature stability measure is output for the user to assess how often the variables are selected across all folds. For sPLS-DA, the classification erro rate is averaged across all folds.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>perf</code> produces a list with the following components:</p>
<dl><dt>MSEP</dt>
<dd><p>Mean Square Error Prediction for each \(Y\) variable, only applies to object inherited from <code>"sPLS"</code>, <code>"gPLS"</code> and <code>"sgPLS"</code>.</p></dd>

  <dt>R2</dt>
<dd><p>a matrix of \(R^2\) values of the \(Y\)-variables for models
    with \(1, \ldots ,\)<code>ncomp</code> components, only applies to object inherited from <code>"sPLS"</code>, <code>"gPLS"</code> and <code>"sgPLS"</code>.</p></dd>

  <dt>Q2</dt>
<dd><p>if \(Y\) contains one variable, a vector of \(Q^2\) values else a list with
    a matrix of \(Q^2\) values for each \(Y\)-variable. Note that in the specific case of an sPLS model, it is better to have a look at the Q2.total criterion, only applies to object inherited from from <code>"sPLS"</code>, <code>"gPLS"</code> and <code>"sgPLS"</code>.</p></dd>

    <dt>Q2.total</dt>
<dd><p>a vector of \(Q^2\)-total values for models with \(1, \ldots ,\)<code>ncomp</code> components, only applies to object inherited from from <code>"sPLS"</code>, <code>"gPLS"</code> and <code>"sgPLS"</code>.</p></dd>

    <dt>features</dt>
<dd><p>a list of features selected across the folds (<code>$stable.X</code> and <code>$stable.Y</code>) or on the whole data set (<code>$final</code>) for the <code>keepX</code> and <code>keepY</code> parameters from the input object.</p></dd>

    <dt>error.rate</dt>
<dd><p>For sPLS-DA, gPLS-DA and sgPLS-DA models, <code>perf</code> produces a matrix of classification error rate estimation.
The dimensions correspond to the components in the model and to the prediction method used, respectively. Note that error rates reported in any component include the performance of the model in earlier components for the specified <code>keepX</code> parameters (e.g. error rate reported for component 3 for <code>keepX = 20</code> already includes the fitted model on components 1 and 2 for  <code>keepX = 20</code>). For more advanced usage of the <code>perf</code> function, see mixOmics package and consider using the <code>predict</code> function.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    	
	
<p>Tenenhaus, M. (1998). <em>La r\'egression PLS: th\'eorie et pratique</em>. Paris: Editions Technic.</p>
<p>Le Cao, K.-A., Rossouw, D., Robert-Grani\'e, C. and Besse, P. (2008). A sparse PLS for variable
selection when integrating Omics data. <em>Statistical Applications in Genetics and Molecular
Biology</em> <b>7</b>, article 35.</p>
<p>Mevik, B.-H., Cederkvist, H. R. (2004). Mean Squared Error of Prediction (MSEP) Estimates for Principal Component
Regression (PCR) and Partial Least Squares Regression (PLSR). <em>Journal of Chemometrics</em> <b>18</b>(9), 422-429.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Benoit Liquet and Pierre Lafaye de Micheaux</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/mixOmics/man/predict.html" class="external-link">predict</a></code>, <code>plot.perf</code> (from package <code>mixOmics</code>)</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## validation for objects of class 'sPLS' (regression)</span></span></span>
<span class="r-in"><span><span class="co">## Example from mixOmics package </span></span></span>
<span class="r-in"><span><span class="co"># ----------------------------------------</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">liver.toxicity</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">liver.toxicity</span><span class="op">$</span><span class="va">gene</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">liver.toxicity</span><span class="op">$</span><span class="va">clinic</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## validation for objects of class 'spls' (regression)</span></span></span>
<span class="r-in"><span><span class="co"># ----------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">ncomp</span> <span class="op">&lt;-</span> <span class="fl">7</span></span></span>
<span class="r-in"><span><span class="co"># first, learn the model on the whole data set</span></span></span>
<span class="r-in"><span><span class="va">model.spls</span> <span class="op">&lt;-</span> <span class="fu"><a href="sPLS.html">sPLS</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, ncomp <span class="op">=</span> <span class="va">ncomp</span>, mode <span class="op">=</span> <span class="st">'regression'</span>,</span></span>
<span class="r-in"><span>   keepX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="va">ncomp</span><span class="op">)</span><span class="op">)</span>, keepY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">ncomp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># with leave-one-out cross validation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model.spls.loo.val</span> <span class="op">&lt;-</span> <span class="fu">perf</span><span class="op">(</span><span class="va">model.spls</span>, validation <span class="op">=</span> <span class="st">"loo"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Q2 total</span></span></span>
<span class="r-in"><span><span class="va">model.spls.loo.val</span><span class="op">$</span><span class="va">Q2.total</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># R2:we can see how the performance degrades when ncomp increases</span></span></span>
<span class="r-in"><span><span class="co"># results are similar to 5-fold</span></span></span>
<span class="r-in"><span><span class="va">model.spls.loo.val</span><span class="op">$</span><span class="va">R2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benoit Liquet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

