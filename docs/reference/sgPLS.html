<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sparse Group Partial Least Squares (sgPLS) — sgPLS • sgPLS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sparse Group Partial Least Squares (sgPLS) — sgPLS"><meta name="description" content="Function to perform  sparse group Partial Least Squares (sgPLS) in the conext of datasets are divided into groups of variables. The sgPLS approach enables selection at both groups and single feature levels."><meta property="og:description" content="Function to perform  sparse group Partial Least Squares (sgPLS) in the conext of datasets are divided into groups of variables. The sgPLS approach enables selection at both groups and single feature levels."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sgPLS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-applications" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Applications</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-applications"><li><a class="dropdown-item" href="../applications/PLS_performance.html">PLS performance</a></li>
    <li><a class="dropdown-item" href="../applications/PLSDA_performance.html">PLSDA performance</a></li>
    <li><a class="dropdown-item" href="../applications/sPLS_performance.html">sPLS performance</a></li>
    <li><a class="dropdown-item" href="../applications/sPLSDA_performance.html">sPLSDA performance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../applications/PLS_performance.html">Performance</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sparse Group Partial Least Squares (sgPLS)</h1>

      <div class="d-none name"><code>sgPLS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to perform  sparse group Partial Least Squares (sgPLS) in the conext of datasets are divided into groups of variables. The sgPLS approach enables selection at both groups and single feature levels.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sgPLS</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, <span class="va">ncomp</span>, mode <span class="op">=</span> <span class="st">"regression"</span>,</span>
<span>     max.iter <span class="op">=</span> <span class="fl">500</span>, tol <span class="op">=</span> <span class="fl">1e-06</span>, <span class="va">keepX</span>, </span>
<span>     keepY <span class="op">=</span> <span class="cn">NULL</span>,<span class="va">ind.block.x</span>, ind.block.y <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">alpha.x</span>, alpha.y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>     upper.lambda <span class="op">=</span> <span class="fl">10</span> <span class="op">^</span> <span class="fl">5</span>,scale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Numeric matrix of predictors.</p></dd>

  <dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Numeric vector or matrix of responses (for multi-response models).</p></dd>

  <dt id="arg-ncomp">ncomp<a class="anchor" aria-label="anchor" href="#arg-ncomp"></a></dt>
<dd><p>The number of components to include in the model (see Details).</p></dd>

  <dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>character string. What type of algorithm to use, (partially) matching
    one of <code>"regression"</code> or <code>"canonical"</code>. See Details.</p></dd>

  <dt id="arg-max-iter">max.iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Integer, the maximum number of iterations.</p></dd>

  <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>A positive real, the tolerance used in the iterative algorithm.</p></dd>

  <dt id="arg-keepx">keepX<a class="anchor" aria-label="anchor" href="#arg-keepx"></a></dt>
<dd><p>Numeric vector of length <code>ncomp</code>, the number of variables
    to keep in \(X\)-loadings. By default all variables are kept in the model.</p></dd>

  <dt id="arg-keepy">keepY<a class="anchor" aria-label="anchor" href="#arg-keepy"></a></dt>
<dd><p>Numeric vector of length <code>ncomp</code>, the number of variables
    to keep in \(Y\)-loadings. By default all variables are kept in the model.</p></dd>

   <dt id="arg-ind-block-x">ind.block.x<a class="anchor" aria-label="anchor" href="#arg-ind-block-x"></a></dt>
<dd><p>A vector of integers describing the grouping of the \(X\) variables. (see an example in Details section).</p></dd>

   <dt id="arg-ind-block-y">ind.block.y<a class="anchor" aria-label="anchor" href="#arg-ind-block-y"></a></dt>
<dd><p>A vector of integers describing the grouping of the \(Y\) variables (see example in Details section).</p></dd>

   <dt id="arg-alpha-x">alpha.x<a class="anchor" aria-label="anchor" href="#arg-alpha-x"></a></dt>
<dd><p>The mixing parameter (value between 0 and 1) related to the sparsity within group for the \(X\) dataset.</p></dd>

    <dt id="arg-alpha-y">alpha.y<a class="anchor" aria-label="anchor" href="#arg-alpha-y"></a></dt>
<dd><p>The mixing parameter (value between 0 and 1) related to the sparsity within group for the \(Y\) dataset.</p></dd>

    <dt id="arg-upper-lambda">upper.lambda<a class="anchor" aria-label="anchor" href="#arg-upper-lambda"></a></dt>
<dd><p>By default <code>upper.lambda=10 ^ 5</code>. A large value specifying the upper bound of the intervall of lambda values for searching the value of the tuning parameter (lambda) corresponding to a non-zero group of variables.</p></dd>

    <dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>a logical indicating if the orignal data set need to be scaled. By default <code>scale</code>=TRUE</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>sgPLS</code> function fit gPLS models with \(1, \ldots ,\)<code>ncomp</code> components.
Multi-response models are fully supported.</p>
<p>The type of algorithm to use is specified with the <code>mode</code> argument. Two gPLS
algorithms are available: gPLS regression <code>("regression")</code> and gPLS canonical analysis
<code>("canonical")</code> (see References).</p>
<p><code>ind.block.x &lt;- c(3, 10, 15)</code> means that \(X\) is structured into 4 groups: X1 to X3; X4 to X10, X11 to X15 and X16 to X\(p\) where \(p\) is the number of variables in the \(X\) matrix.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>sgPLS</code> returns an object of class <code>"sgPLS"</code>, a list
that contains the following components:</p>
<p></p>
<dl><dt>X</dt>
<dd><p>The centered and standardized original predictor matrix.</p></dd>

  <dt>Y</dt>
<dd><p>The centered and standardized original response vector or matrix.</p></dd>

  <dt>ncomp</dt>
<dd><p>The number of components included in the model.</p></dd>

  <dt>mode</dt>
<dd><p>The algorithm used to fit the model.</p></dd>

  <dt>keepX</dt>
<dd><p>Number of \(X\) variables kept in the model on each component.</p></dd>

  <dt>keepY</dt>
<dd><p>Number of \(Y\) variables kept in the model on each component.</p></dd>

  <dt>mat.c</dt>
<dd><p>Matrix of coefficients to be used internally by <code>predict</code>.</p></dd>

  <dt>variates</dt>
<dd><p>List containing the variates.</p></dd>

  <dt>loadings</dt>
<dd><p>List containing the estimated loadings for the \(X\) and
	\(Y\) variates.</p></dd>

  <dt>names</dt>
<dd><p>List containing the names to be used for individuals and variables.</p></dd>

  <dt>tol</dt>
<dd><p>The tolerance used in the iterative algorithm, used for subsequent S3 methods.</p></dd>

  <dt>max.iter</dt>
<dd><p>The maximum number of iterations, used for subsequent S3 methods.</p></dd>

  <dt>iter</dt>
<dd><p>Vector containing the number of iterations for convergence in each component.</p></dd>

  <dt>ind.block.x</dt>
<dd><p>A vector of integers describing the grouping of the \(X\) variables.</p></dd>

  <dt>ind.block.y</dt>
<dd><p>A vector of consecutive integers describing the grouping of the \(Y\) variables.</p></dd>

  <dt>alpha.x</dt>
<dd><p>The mixing parameter related to the sparsity within group for the \(X\) dataset.</p></dd>

    <dt>alpha.y</dt>
<dd><p>The mixing parameter related to the sparsity within group for the \(Y\) dataset.</p></dd>

    <dt>upper.lambda</dt>
<dd><p>The upper bound of the intervall of lambda values for searching the value of the tuning parameter (lambda) corresponding to a non-zero group of variables.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Liquet Benoit, Lafaye de Micheaux, Boris Hejblum, Rodolphe Thiebaut (2016). A group and Sparse Group Partial Least Square approach applied in Genomics context. <em>Bioinformatics</em>.</p>
<p>Le Cao, K.-A., Martin, P.G.P., Robert-Grani\'e, C. and Besse, P. (2009). Sparse canonical methods for biological data integration: application to a cross-platform study. <em>BMC Bioinformatics</em> <b>10</b>:34.</p>
<p>Le Cao, K.-A., Rossouw, D., Robert-Grani\'e, C. and Besse, P. (2008). A sparse PLS for variable
selection when integrating Omics data. <em>Statistical Applications in Genetics and Molecular
Biology</em> <b>7</b>, article 35.</p>
<p>Shen, H. and Huang, J. Z. (2008). Sparse principal component analysis via regularized
low rank matrix approximation. <em>Journal of Multivariate Analysis</em> <b>99</b>, 1015-1034.</p>
<p>Tenenhaus, M. (1998). <em>La r\'egression PLS: th\'eorie et pratique</em>. Paris: Editions Technic.</p>
<p>Wold H. (1966). Estimation of principal components and related models by iterative least squares.
In: Krishnaiah, P. R. (editors), <em>Multivariate Analysis</em>. Academic Press, N.Y., 391-420.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Benoit Liquet and Pierre Lafaye de Micheaux.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sPLS.html">sPLS</a></code>, <code>sgPLS</code>, <code><a href="https://rdrr.io/pkg/mixOmics/man/predict.html" class="external-link">predict</a></code>, <code><a href="perf.html">perf</a></code> and functions from <code>mixOmics</code> package: <code>summary</code>, <code>plotIndiv</code>, <code>plotVar</code>, <code>plot3dIndiv</code>, <code>plot3dVar</code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">## Simulation of datasets X and Y with group variables</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">sigma.gamma</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">sigma.e</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">400</span></span></span>
<span class="r-in"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">theta.x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span>             ,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">325</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta.x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">320</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span>             ,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">theta.y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span>             ,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">425</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta.y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">420</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>                             </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Sigmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">p</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">Sigmax</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sigma.e</span> <span class="op">^</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">Sigmay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">q</span>, ncol <span class="op">=</span> <span class="va">q</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">Sigmay</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sigma.e</span> <span class="op">^</span> <span class="fl">2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">125</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gam1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gam2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gam1</span>, <span class="va">gam2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">theta.x1</span>, <span class="va">theta.x2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span></span></span>
<span class="r-in"><span>     <span class="va">Sigmax</span>, method <span class="op">=</span> <span class="st">"svd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gam1</span>, <span class="va">gam2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">theta.y1</span>, <span class="va">theta.y2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">q</span><span class="op">)</span>, sigma <span class="op">=</span></span></span>
<span class="r-in"><span>     <span class="va">Sigmay</span>, method <span class="op">=</span> <span class="st">"svd"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ind.block.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">380</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ind.block.y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">480</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model.sgPLS</span> <span class="op">&lt;-</span> <span class="fu">sgPLS</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, ncomp <span class="op">=</span> <span class="fl">2</span>, mode <span class="op">=</span> <span class="st">"regression"</span>, keepX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                   keepY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, ind.block.x <span class="op">=</span> <span class="va">ind.block.x</span></span></span>
<span class="r-in"><span>                   ,ind.block.y <span class="op">=</span> <span class="va">ind.block.y</span>,</span></span>
<span class="r-in"><span>                   alpha.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.95</span><span class="op">)</span>, alpha.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">result.sgPLS</span> <span class="op">&lt;-</span> <span class="fu"><a href="select.sgpls.html">select.sgpls</a></span><span class="op">(</span><span class="va">model.sgPLS</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result.sgPLS</span><span class="op">$</span><span class="va">group.size.X</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    size comp1 comp2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    20    15     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    20    15     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    20    16     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    20    15     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   20     0    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   20     0    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   20     0    16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   20     0    15</span>
<span class="r-in"><span><span class="va">result.sgPLS</span><span class="op">$</span><span class="va">group.size.Y</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    size comp1 comp2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    20    15     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    20    15     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    20    16     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    20    16     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21   20     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   20     0    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23   20     0    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24   20     0    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25   20     0    15</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benoit Liquet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

